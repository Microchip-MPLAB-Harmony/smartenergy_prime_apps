<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2022" />
<meta name="DC.rights.owner" content="(C) Copyright 2022" />
<meta name="DC.type" content="concept" />
<meta name="DC.title" content="Appendix B. G3-PLC SQLite Log Database" />
<meta name="DC.relation" scheme="URI" content="GUID-8D66ECA9-8C74-42B9-8915-33D381579FBB.html" />
<meta name="DC.relation" scheme="URI" content="GUID-C38003EC-3345-481E-B69C-EA4F23795447.html" />
<meta name="DC.relation" scheme="URI" content="GUID-E8EA7841-B747-4373-9373-443D66C7E220.html" />
<meta name="DC.relation" scheme="URI" content="GUID-66762CCC-9D4D-406B-94FD-EB2C7F863A64.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F" />
<meta name="DC.language" content="en-US" />
<link rel="stylesheet" type="text/css" href="stylesheets/commonltr.css" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<link rel="stylesheet" type="text/css" href="./stylesheets/common-extended.css" /><title>Appendix B. G3-PLC SQLite Log Database</title>
<meta name="Microsoft.Help.Id" content="GUID-B0EED1DD-60EE-41BF-A319-00EF8C6E51CB-GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F" />
<meta name="Microsoft.Help.TocParent" content="GUID-B0EED1DD-60EE-41BF-A319-00EF8C6E51CB-GUID-8D66ECA9-8C74-42B9-8915-33D381579FBB" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLAB® Harmony Smart Energy PRIME Applications Reference A 04/2022" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
        function cpy(id, button) {
        
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                    button.textContent = "Copy";
                    button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
              console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
        }
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style></head>
<body id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F">

<h1 class="title topictitle1" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-91313850-BD27-44EB-AA23-4DDCDBFA3E99">Appendix B. G3-PLC SQLite Log Database</h1>
<div class="body conbody">
        <p class="p" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__ID-00000378">The PLC Sniffer creates a relational database using SQLite to store the
            G3-PLC logs. Using this type of database to store the information helps to handle logs
            from complex networks and to inspect the data in very flexible ways. Third party tools
            to handle SQLite databases can also be used. A useful tool for SQLite database
            inspection is the <em class="ph i">SQLite Manager</em> plug-in for Firefox browser.</p>

        <div class="p" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__ID-0000037B">The current version of the database has 14 tables:<ul class="ul" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__UL_LRT_N1N_SCB">
                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-BCECCA61-ADD5-403B-98F3-F792ED0DAAED"><strong class="ph b">LogInfo:</strong> contains information about the database</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-EC68C30B-741C-4C5B-9D31-A63CFFA88277"><strong class="ph b">Frame:</strong> each row of this table represents a PLC message on the power line.
                    This table contains the information displayed on the Capture and Log windows.
                    Includes the raw data of the received PDU and some parameters from the PHY Layer
                    provided by the hardware. Also includes a timestamp value</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-FA040481-F9F4-4261-987F-0BF0AB5D7B34"><strong class="ph b">Beacon:</strong> disassembled
                    information of the Beacon PDU as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-B07653E0-D4B8-421B-9001-BFC7F06BBB6D"><strong class="ph b">Data:</strong> data PDU as defined
                    in G3-PLC standard. The data payload may contain a message from the adaptation
                    sublayer. If possible, it will be disassembled and the proper information will
                    be inserted in MeshHeader, BroadcastHeader, FragmentationHeader, LBP_Header,
                    LBP_EAP and LBP_ConfParam tables</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-18E09124-5D1E-4914-B682-8ED26CBEC4B7"><strong class="ph b">ToneMapResponse:</strong>
                    disassembled information of the Tone Map Response PDU as defined in G3-PLC
                    standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-82B00D9C-5C94-45F5-85DB-7E9BD3CA12AC"><strong class="ph b">DecryptedData:</strong> When data payload is encrypted and the key is known, the
                    decrypted data will be stored in this table. The key will only be known if the
                    capture starts before the bootstrapping</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-089B7960-CB59-4902-AD6E-04F3B8427E08"><strong class="ph b">MeshHeader:</strong> disassembled
                    Mesh Header encapsulated in Data PDU as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-70474A53-01F3-4446-9371-E1D7E3FE9A47"><strong class="ph b">BroadcastHeader:</strong>
                    disassembled broadcast header encapsulated in Data PDU as defined in G3-PLC
                    standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-2C47F032-4D4B-462F-AF25-6465D597F3C1"><strong class="ph b">FragmentationHeader:</strong>
                    disassembled fragmentation header encapsulated in Data PDU as defined in G3-PLC
                    standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-19B7F759-AC69-40CD-BF59-54009655A450"><strong class="ph b">LBP_Header:</strong> disassembled
                    LoWPAN bootstrapping protocol header encapsulated in Data PDU as defined in
                    G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-0AEF795F-530C-440A-8985-6D6B9FBD8827"><strong class="ph b">LBP_EAP:</strong> disassembled EAP
                    message encapsulated in Data PDU as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-DC80A4A4-7C45-464D-A19A-EBEB85D390C1"><strong class="ph b">LBP_ConfParam:</strong>
                    disassembled configuration parameter message encapsulated in Data PDU as defined
                    in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-4F84871D-FB18-4B1C-9AB2-E22982FC0293"><strong class="ph b">RREQ:</strong> disassembled Route
                    Request (message type of LOADng routing protocol) message encapsulated in Data
                    PDU as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-6F548ECD-BA51-475A-A4F7-3ECE5754C87A"><strong class="ph b">RREP:</strong> disassembled Route
                    Reply (message type of LOADng routing protocol) message encapsulated in Data PDU
                    as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-A20057BD-023C-427A-B6E7-57416015435F"><strong class="ph b">RERR:</strong> disassembled Route
                    Error (message type of LOADng routing protocol) message encapsulated in Data PDU
                    as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-6E28F13C-B535-43CE-8B1E-86849D8F4EBD"><strong class="ph b">PREQ:</strong> disassembled Path
                    Request (message type of LOADng routing protocol) message encapsulated in Data
                    PDU as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-5CEF5C65-9D16-4912-8635-8B57B259E23E"><strong class="ph b">PREP:</strong> disassembled Path
                    Reply (message type of LOADng routing protocol) message encapsulated in Data PDU
                    as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-58F9552E-4A63-40D6-8A09-423C11CF3343"><strong class="ph b">RLCREQ:</strong> disassembled Route
                    Link Cost Request (message type of LOADng routing protocol) message encapsulated
                    in Data PDU as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-992ABE35-CCE6-49D9-9864-EBC49238041A"><strong class="ph b">RLCREP:</strong> disassembled Route
                    Link Cost Reply (message type of LOADng routing protocol) message encapsulated
                    in Data PDU as defined in G3-PLC standard</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-4C031350-1D8F-42FE-8EE6-A87957EA6AF0"><strong class="ph b">LOADng_ForwardPaths:</strong> Forward paths associated to a PREQ message</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-79EEB2A6-62D8-40A9-A4B0-98B1DF88AEE6"><strong class="ph b">LOADng_ReversePaths:</strong> Reverse paths associated to a PREQ message</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-A1D109FA-7BDC-4E20-9291-91AD42EA92A7"><strong class="ph b">Node:</strong> table containing the current status of all the nodes detected on
                    the network</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-830DB408-9087-41FA-A727-5514609ACB04"><strong class="ph b">Event:</strong> table containing the status events that define the node table.
                    This table allows to reproduce the status of a node at any time of the log</li>

                <li class="li" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__GUID-541128DF-9818-48A2-8BCC-5838EAFB2F5D"><strong class="ph b">G3KH:</strong> G3-PLC Key
                    hierarchy, table containing all the keys knows by the sniffer. If the PSK key is
                    supplied, the sniffer will know all key hierarchy and when a bootstrap sequence
                    is completed, the sniffer will learn the GMK key</li>

            </ul>
</div>

        <p class="p" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__ID-000003AD">All tables are linked through a common “idFrame” index. This unique
            index is assigned when a new frame is inserted on the database. This allows building
            complex search queries with SQL. <a class="xref" href="#GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__FIG_ELQ_2BN_SCB">Figure 1</a> and
                <a class="xref" href="#GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__FIG_JMY_GBN_SCB">Figure 2</a> show the tables and relations of a
            G3-PLC log database. Table fields are encoded as specified in the PRIME standard except
            CmdType Identifier. This field is specified in the next section.</p>

        <div class="fig fignone" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__FIG_ELQ_2BN_SCB"><div class="figcap"><span class="fig--title-label">Figure 1. </span>PLC Sniffer G3 Log Database,
                Part-1</div>
            
            <img class="image" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__ID-000003C2" src="GUID-5B6A5175-CBDD-4BC3-AFB5-3DDD7124D0D7-low.png" width="598" height="852" />
        </div>

        <div class="fig fignone" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__FIG_JMY_GBN_SCB"><div class="figcap"><span class="fig--title-label">Figure 2. </span>PLC Sniffer G3 Log Database,
                Part-2</div>
            
            <img class="image" id="GUID-B1D36D7B-7A26-4B4E-B5DB-E314EF9CEF9F__IMAGE_DL2_FMW_TCB" src="GUID-FB07A343-281F-4F47-9087-9DA3BC6599C2-low.png" height="546" width="641" />
        </div>

    </div>

<div class="related-links">
<ul class="ullinks">
<li class="link ulchildlink"><strong><a href="GUID-C38003EC-3345-481E-B69C-EA4F23795447.html">Command Type Identifier</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-E8EA7841-B747-4373-9373-443D66C7E220.html">Event Table</a></strong><br />
</li>
<li class="link ulchildlink"><strong><a href="GUID-66762CCC-9D4D-406B-94FD-EB2C7F863A64.html">Sample SQLite Filters</a></strong><br />
</li>
</ul>

<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-8D66ECA9-8C74-42B9-8915-33D381579FBB.html">PHY Sniffer</a></div>
</div>
</div></body>
</html>